\documentclass[12pt,a4paper]{article}

\usepackage[english]{babel}
\usepackage{listings}
\usepackage{ucs}
\usepackage{color}

%%%%% LAY OUT %%%%%%
\linespread{1.2}
\usepackage[margin=1in]{geometry}
\usepackage{tabularx}
\usepackage{fancyhdr}
\usepackage{verbatim}
\usepackage{enumerate}
\usepackage{sectsty}								
\allsectionsfont{}	% Change font of al section commands


\pagestyle{fancy}
\lhead{}
\rhead{\nouppercase{\leftmark}}
\lfoot{}
\rfoot{}
\cfoot{\thepage}
\renewcommand{\headrulewidth}{0.4pt}
\renewcommand{\footrulewidth}{0.4pt}

\usepackage{graphicx}

%%%%% MATH %%%%%
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{multirow}
\usepackage{mathtools}	
\usepackage{wasysym}
\usepackage{amssymb}
\usepackage{amscd}
\usepackage{xfrac}
\numberwithin{equation}{section}




\newtheorem{theorem}{Theorem}
\newtheorem{lemma}{Lemma}
\newtheorem{corollary}{Corollary}

\usepackage{dsfont}
\usepackage{bm}

\usepackage{titlesec}

\newcommand{\p}[1]{\mathds{P}\left\{#1\right\}}

\begin{document}

\title{Integrating the likelihood function of the somatic mutation latent variable model}
\author{Louis Dijkstra\footnote{E-mail: \texttt{dijkstra@cwi.nl}}}

\maketitle

The goal is to compute/estimate the integral \footnote{The prior $h(\theta_h, \theta_c)$ is initially assumed uniform over the parameter space.}
\begin{equation}
 \int_a^b L(\theta_h, \theta_c \mid Z^h, Z^c) d\theta_c \qquad (\theta_h \text{ is fixed})
\end{equation}
where 
\begin{equation}
 L(\theta_h, \theta_c \mid Z^h, Z^c) = \prod_{i=1}^k g_i^h\left(Z^h_i \mid \theta_h \right) \times \prod_{j=1}^l g_j^c \left(Z_j^c \mid \theta_h, \theta_c; \alpha \right).
 \end{equation}
Note that we can rewrite the integral to 
\begin{equation}
  \underbrace{\prod_{i=1}^k g_i^h\left(Z^h_i \mid \theta_h \right)}_{\text{constant}} \times \int_a^b \prod_{j=1}^l g_j^c \left(Z_j^c \mid \theta_h, \theta_c; \alpha \right) d\theta_c. 
\label{eq:int}
  \end{equation}
The conditional probability distribution for observation $g_j^c \left(Z_j^c \mid \theta_h, \theta_c; \alpha \right)$ can be written as: 
\begin{equation}
 g_j^c \left(Z_j^c \mid \theta_h, \theta_c; \alpha \right) = s_j \theta_c + t_j
\end{equation}
where 
\begin{equation}
 s_j = (1 - \alpha)\left[p_j^c\left(Z_j\right) - a_j^c\left(Z_j \right) \right]
\end{equation}
and 
\begin{equation}
 t_j =   \pi_j^c \alpha \left[\theta_h p_j^c\left(Z_j\right) + \left(1 - \theta_h \right) a_j^c\left(Z_j \right) \right] + (1 - \alpha)a_j^c\left(Z_j \right) + \left(1 - \pi_j^c\right) u_j^c \left(Z_j \right).
\end{equation}
The product $\prod_{j=1}^l g_j^c \left(Z_j^c \mid \theta_h, \theta_c; \alpha \right)$ can, therefore, be written as $m$-order polynomial
\begin{equation}
 \prod_{j=1}^l \left(s_j \theta_c + t_j\right) = \sum_{m=0}^k \beta_m \theta_c^m
\end{equation}
with coefficients 
\begin{equation}
 \beta_m = \sum_{\substack{
            I \subset \{1,\dots,l\}\\
            |I| = m}} \prod_{i \in I} s_i \prod_{j \not\in I} t_j
            \label{eq:beta}
\end{equation}
The integral in (\ref{eq:int}) can be written as 
\begin{equation}
 \int_a^b \sum_{m=0}^k \beta_m \theta_c^m d\theta_h = \sum_{m=0}^k \frac{\beta_m}{m+1} \left(b^{m+1}-a^{m+1}\right). 
\end{equation}
What remains is determining the coefficients $\beta_0, \dots, \beta_m$ efficiently. Computing them directly from eq. (\ref{eq:beta}) is infeasbile, since it requires us to sum over all possible subsets of observations. We propose the following iterative process: 
\begin{description}
 \item[\textsc{Initialization}] $\beta_0^{(0)} := 1$ 
 \item[\textsc{Update steps}] add every observation $i = 1,2,\dots,l$ one by one and `update' the coefficients with the following rules: 
 \begin{equation}
  \begin{aligned}
   \beta_0^{(i)} &= \beta_0^{(i-1)} t_i \\ 
   \beta_m^{(i)} &= \beta_m^{(i-1)} t_i + \beta_{m-1}^{i-1} s_i \quad (m = 1,2\dots,i-1) \\ 
   \beta_i^{(i)} &= \beta_{i-1}^{(i-1)} s_i. 
  \end{aligned}
 \end{equation}
 \item[\textsc{Termination}] the coefficients $\beta_1, \dots, \beta_m$ are 
 \begin{equation}
  \beta_m = \beta_m^{(l)} \text{ for }m = 1,2,\dots,l.
 \end{equation}


\end{description}

\paragraph{Arbitrary prior distribution} In case of an arbitrary prior, the integral 
\begin{equation}
  \int_a^b L(\theta_h, \theta_c \mid Z^h, Z^c) h(\theta_h, \theta_c) d\theta_c \qquad (\theta_h \text{ is fixed})
\end{equation}




\end{document}
